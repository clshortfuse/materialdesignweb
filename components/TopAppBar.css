/* https://m3.material.io/components/bottom-app-bar/specs */

:host {
  --mdw-bg: var(--mdw-color__surface);
  --mdw-ink: var(--mdw-color__on-surface);
  --mdw-container__elevation__opacity: var(--mdw-container__elevation__opacity__0);
  position: sticky;
  inset-block-start: 0;

  z-index:2;
}

:host([hide-on-scroll]) {
  display: contents;
}

#bar {
  position: relative;

  display: grid;
  align-items: center;
  grid-auto-flow: row;
  grid-template-rows: minmax(64px,min-content) minmax(0, min-content);
  grid-template-columns: minmax(auto,1fr) 12px minmax(0,auto) 12px minmax(auto,1fr);

  box-sizing: border-box;
  inline-size: 100%;
  max-inline-size: 100%;

  /* 16px from icon */
  /* inset = (button.width / 2) - (icon.width / 2) */
  /* paddingInline = 16px - inset */
  /* paddingInlineStart = 16px - ((48px / 2) - (24px / 2)) */
  /* paddingInlineEnd = 16px - ((48px / 2) - (30px / 2)) */

  padding-inline: 4px;

  z-index:1;

  background-color: rgb(var(--mdw-bg));
  box-shadow: none;
  color: rgb(var(--mdw-ink));

  font: var(--mdw-typescale__title-large__font);
  letter-spacing: var(--mdw-typescale__title-large__letter-spacing);
  white-space: nowrap;

  transition: grid-template-columns 100ms;
}

#elevation {
  z-index: 1
}

:host([raised]) {
  --mdw-container__elevation__opacity: var(--mdw-container__elevation__opacity__2);
}

:host([color]:not([color|="surface"])) #elevation,
:host([color]:not([color|="surface"])) #companion::before {
  display: none;
}

#leading {
  display: flex;
  align-items: center;

  grid-column: 1;
  grid-row: 1;

}

#headline {
  display: block;
  overflow-x: clip;

  overflow-y: hidden;
  overflow-y: hidden;

  grid-column: 3;
  grid-row: 1;

  text-overflow: ellipsis;
  text-transform: none;
  word-break: break-word;

  transition-duration: 200ms;
  transition-property: transform, opacity, color, background-color;
}

#trailing {
  display: flex;
  align-items: center;
  justify-content: flex-end;

  grid-column: 5;
  grid-row: 1;

  color: var(--mdw-color__on-surface-variant);
}

#companion {
  position: relative;

  display: flex;
  align-items: flex-end;

  margin-block-start: -4px;
  padding-block-end: 20px;

  padding-inline: 16px;

  background-color: rgb(var(--mdw-bg));
  box-shadow: none;

  font: var(--mdw-typescale__headline-small__font);
  letter-spacing: var(--mdw-typescale__headline-small__letter-spacing);
  white-space: nowrap;
}

#companion-text {
  display: block;
  overflow-x: clip;

  overflow-y: hidden;
  overflow-y: hidden;

  text-overflow: ellipsis;
  text-transform: none;

  word-break: break-word;
}

:host([size="large"]) #companion {
  min-block-size: 108px;

  font: var(--mdw-typescale__headline-medium__font);
  letter-spacing: var(--mdw-typescale__headline-medium__letter-spacing);
  white-space: normal;
}

:host([size="large"]) #companion-text {
  max-block-size: calc(2 * var(--mdw-typescale__headline-medium__line-height));
}

@supports(-webkit-line-clamp: 2) {
  :host([size="large"]) #companion-text {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;

    max-block-size: none;
  }
}

#companion::before {
  /* Cloned from #elevation */
  content: '';

  position: absolute;
  inset: 0;

  pointer-events: none;

  opacity: var(--mdw-container__elevation__opacity, 0);
  visibility: var(--mdw-container__elevation__visibility);

  background-color: rgb(var(--mdw-container__elevation__color));
  border-radius: inherit;

  transition-delay: 1ms;
  transition-duration: 200ms;
  transition-property: opacity, color, background-color;
}

:host([hide-on-scroll]) #bar {
  position: relative;

  inset-block-start: 0;

  transform: translateY(0);

  will-change: transform, position;
}

:host([size="small"]) #bar {
  grid-template-columns: auto 4px 1fr 4px auto;
}

:host(:is([size="medium"],[size="large"])) #headline {
  opacity: 0;
  transform: translateY(-25%);

  will-change: transform, opacity;
}

:host([hide-on-scroll][raised]:is([size="medium"],[size="large"])) #headline {
  opacity: 1;
  transform: translateY(0);
}
